<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>عداد الأذكار</title>
  <style>
    body {
      background-color: #0b0c10;
      color: #e6edf3;
      font-family: system-ui, sans-serif;
      text-align: center;
      margin: 0;
      padding: 20px;
      direction: rtl;
    }

    h1 { margin-top: 0; font-size: 22px; }

    .controls {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-top: 15px;
      flex-wrap: wrap;
    }

    .controls button {
      background-color: #213445;
      border: none;
      color: white;
      padding: 10px 16px;
      border-radius: 8px;
      font-size: 15px;
      cursor: pointer;
      transition: 0.2s;
    }

    .controls button:hover { background-color: #2a4b5e; }
    .controls button.active { background-color: #3ea6ff; color: black; }

    .counter-circle {
      width: 160px;
      height: 160px;
      border-radius: 50%;
      background-color: #1f232b;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 30px auto 10px;
      font-size: 36px;
      font-weight: bold;
      position: relative;
      border: 4px solid #3ea6ff;
    }

    input[type="range"] {
      width: 250px;
      accent-color: #3ea6ff;
      cursor: pointer;
    }

    .slider-row {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      margin: 10px 0;
    }

    .slider-btn {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background: #213445;
      color: #fff;
      border: none;
      font-size: 18px;
      cursor: pointer;
    }

    select {
      background-color: #1f232b;
      color: white;
      padding: 8px;
      border-radius: 8px;
      border: 1px solid #3a4654;
    }

    .preset-btn {
      background-color: #2a3a44;
      padding: 10px 14px;
      border-radius: 10px;
      cursor: pointer;
      margin: 4px;
      border: none;
      color: white;
      font-weight: bold;
    }

    .preset-btn.active {
      background-color: #3ea6ff;
      color: black;
    }

    .manual-controls {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 14px;
      margin-top: 15px;
    }

    .manual-controls button {
      width: 48px;
      height: 48px;
      font-size: 26px;
      border-radius: 50%;
      border: none;
      background-color: #213445;
      color: white;
      cursor: pointer;
    }

    #eta {
      color: #9aa4b2;
      margin-top: 8px;
      font-size: 14px;
    }

    .nav-link {
      display: inline-block;
      margin-top: 16px;
      padding: 10px 14px;
      border-radius: 12px;
      background: #2a3a44;
      color: #e6edf3;
      text-decoration: none;
      font-weight: 700;
    }
  </style>
</head>
<body>
  <h1>عداد الأذكار</h1>

  <div class="controls">
    <select id="interval">
      <option value="1">1 ثانية</option>
      <option value="2">2 ثوانٍ</option>
      <option value="3">3 ثوانٍ</option>
      <option value="4">4 ثوانٍ</option>
      <option value="5">5 ثوانٍ</option>
      <option value="10">10 ثوانٍ</option>
    </select>
  </div>

  <div class="slider-row">
    <button class="slider-btn" id="decLimit">−</button>
    <input type="range" id="limit" min="0" max="100" value="0">
    <button class="slider-btn" id="incLimit">+</button>
  </div>

  <div id="eta">الوقت المقدر: 0 ثانية</div>

  <div class="counter-circle" id="counter">0</div>

  <div class="manual-controls">
    <button id="decrement">−</button>
    <button id="increment">+</button>
  </div>

  <div class="controls">
    <button id="start">ابدأ</button>
    <button id="stop">إيقاف</button>
    <button id="reset">تصفير</button>
  </div>

  <div class="controls" id="presets">
    <button class="preset-btn" data-interval="1" data-limit="100">سبحان الله وبحمده</button>
    <button class="preset-btn" data-interval="3" data-limit="100">لا إله إلا أنت سبحانك إني كنت من الظالمين</button>
    <button class="preset-btn" data-interval="4" data-limit="100">لا إله إلا الله وحده لا شريك له، له الملك وله الحمد وهو على كل شيء قدير</button>
  </div>

  <a href="adhkar.html" class="nav-link">أذكار الصباح والمساء</a>

  <audio id="ding" src="https://actions.google.com/sounds/v1/alarms/beep_short.ogg"></audio>

  <script>
    let count = 0;
    let limit = 0;
    let intervalSec = 1;
    let running = false;
    let timer;
    const $counter = document.getElementById("counter");
    const $interval = document.getElementById("interval");
    const $limit = document.getElementById("limit");
    const $eta = document.getElementById("eta");
    const $ding = document.getElementById("ding");

    const $start = document.getElementById("start");
    const $stop = document.getElementById("stop");
    const $reset = document.getElementById("reset");
    const $incLimit = document.getElementById("incLimit");
    const $decLimit = document.getElementById("decLimit");

    const $inc = document.getElementById("increment");
    const $dec = document.getElementById("decrement");

    const presets = document.querySelectorAll(".preset-btn");

    function updateCounter() {
      $counter.textContent = count;
    }

    function refreshETA() {
      if (limit > 0 && intervalSec > 0) {
        const remaining = Math.max(0, limit - count);
        const seconds = remaining * intervalSec;
        const minutes = Math.floor(seconds / 60);
        const secs = seconds % 60;
        $eta.textContent = `الوقت المقدر: ${minutes > 0 ? minutes + " دقيقة و " : ""}${secs} ثانية`;
      } else {
        $eta.textContent = `الوقت المقدر: 0 ثانية`;
      }
    }

    function tick() {
      if (!running) return;
      count++;
      updateCounter();
      if (limit > 0 && count >= limit) {
        $ding.play();
        running = false;
        clearInterval(timer);
        alert(`تم الوصول إلى الحد: ${limit}`);
      }
      refreshETA();
    }

    function start() {
      if (running) return;
      if (count > 0) {
        const choice = confirm("هل ترغب في تصفير العداد قبل البدء؟");
        if (choice) {
          count = 0;
          updateCounter();
        }
      }
      running = true;
      $start.classList.add("active");
      timer = setInterval(tick, intervalSec * 1000);
    }

    function stop() {
      running = false;
      $start.classList.remove("active");
      clearInterval(timer);
    }

    function reset() {
      stop();
      count = 0;
      updateCounter();
      refreshETA();
    }

    $interval.addEventListener("change", () => {
      intervalSec = parseInt($interval.value);
      refreshETA();
    });

    $limit.addEventListener("input", () => {
      limit = parseInt($limit.value);
      refreshETA();
    });

    $incLimit.addEventListener("click", () => {
      $limit.value = Math.min(100, parseInt($limit.value) + 1);
      limit = parseInt($limit.value);
      refreshETA();
    });

    $decLimit.addEventListener("click", () => {
      $limit.value = Math.max(0, parseInt($limit.value) - 1);
      limit = parseInt($limit.value);
      refreshETA();
    });

    $inc.addEventListener("click", () => {
      count++;
      if (limit > 0 && count >= limit) {
        $ding.play();
        alert(`تم الوصول إلى الحد: ${limit}`);
      }
      updateCounter();
      refreshETA();
    });

    $dec.addEventListener("click", () => {
      count = Math.max(0, count - 1);
      updateCounter();
      refreshETA();
    });

    presets.forEach(btn => {
      btn.addEventListener("click", () => {
        if (btn.classList.contains("active")) {
          btn.classList.remove("active");
          limit = 0;
          intervalSec = 1;
          $interval.value = "1";
          $limit.value = 0;
        } else {
          presets.forEach(b => b.classList.remove("active"));
          btn.classList.add("active");
          intervalSec = parseInt(btn.dataset.interval);
          limit = parseInt(btn.dataset.limit);
          $interval.value = intervalSec;
          $limit.value = limit;
        }
        refreshETA();
      });
    });

    $start.addEventListener("click", start);
    $stop.addEventListener("click", stop);
    $reset.addEventListener("click", reset);

    // Defaults on page load
    window.addEventListener("load", () => {
      $interval.value = "1";
      $limit.value = 0;
      intervalSec = 1;
      limit = 0;
      count = 0;
      updateCounter();
      refreshETA();
    });
  </script>
</body>
</html>
